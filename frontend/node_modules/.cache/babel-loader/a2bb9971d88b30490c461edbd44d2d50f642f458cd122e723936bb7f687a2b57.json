{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import QRCode from'react-qr-code';import QRScanner from'./QRScanner';import StudentAttendance from'./StudentAttendance';import StudentSummary from'./StudentSummary';import'./Dashboard.css';import{API_BASE}from'../config';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Dashboard(_ref){let{user,setUser}=_ref;const[sessionId,setSessionId]=useState(null);const[token,setToken]=useState('');const[showQR,setShowQR]=useState(false);const[activeView,setActiveView]=useState('dashboard');const[classId,setClassId]=useState(null);const[classes,setClasses]=useState([]);const[loadingClasses,setLoadingClasses]=useState(false);const logout=()=>{setUser(null);};const createDefaultClass=React.useCallback(async()=>{try{const response=await axios.post(\"\".concat(API_BASE,\"/api/classes\"),{class_name:\"\".concat(user.name,\"'s Class\"),teacher_id:user.id});setClasses([response.data]);setClassId(response.data.id);}catch(err){alert('Failed to create default class. Please create a class first.');}},[user.id,user.name]);const loadClasses=React.useCallback(async()=>{setLoadingClasses(true);try{const response=await axios.get(\"\".concat(API_BASE,\"/api/classes?teacher_id=\").concat(user.id));if(response.data&&response.data.length>0){setClasses(response.data);setClassId(response.data[0].id);}else{// Auto-create a default class for the teacher\nawait createDefaultClass();}}catch(err){console.error('Error loading classes:',err);}finally{setLoadingClasses(false);}},[user.id,createDefaultClass]);// Load classes for teacher on mount\nuseEffect(()=>{if((user===null||user===void 0?void 0:user.role)==='teacher'){loadClasses();}},[user,loadClasses]);const generateQR=async()=>{if(!classId){alert('Please select a class first or create one.');return;}try{const code=\"CLASS-\".concat(user.id,\"-\").concat(Date.now());const response=await axios.post(\"\".concat(API_BASE,\"/api/create-session\"),{class_id:classId,qr_code:code});// Use the session_id to get rotating tokens\nif(response.data.session_id){setSessionId(response.data.session_id);setShowQR(true);}}catch(err){var _err$response,_err$response$data;let errorMessage='Failed to generate QR code';if(err.code==='ERR_NETWORK'||err.message.includes('Network Error')){errorMessage=\"Cannot connect to server. Please make sure the backend server is running on \".concat(API_BASE);}else if((_err$response=err.response)!==null&&_err$response!==void 0&&(_err$response$data=_err$response.data)!==null&&_err$response$data!==void 0&&_err$response$data.error){errorMessage=err.response.data.error;// If class doesn't exist, try to create one\nif(errorMessage.includes('does not exist')){await createDefaultClass();errorMessage+='\\n\\nA default class has been created. Please try again.';}}else{errorMessage=\"Failed to generate QR code: \".concat(err.message);}alert(errorMessage);}};// Poll rotating token when a session is active (7 seconds window)\nuseEffect(()=>{if(!sessionId)return;let timer=null;const fetchToken=async()=>{try{const r=await axios.get(\"\".concat(API_BASE,\"/api/qr/\").concat(sessionId,\"/current\"));setToken(r.data.token);// refresh faster than server window size (7 seconds) - refresh every 5 seconds\nconst ws=r.data.window_seconds||7;timer=setTimeout(fetchToken,Math.max(3000,ws*700));// 70% of window time\n}catch(e){// ignore transient errors, but log for debugging\nconsole.error('Error fetching token:',e);}};fetchToken();return()=>{if(timer)clearTimeout(timer);};},[sessionId]);const renderDashboardContent=()=>{if(activeView==='qr'&&user.role==='teacher'){return/*#__PURE__*/_jsxs(\"div\",{className:\"feature-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Generate QR Code\"}),loadingClasses?/*#__PURE__*/_jsx(\"p\",{children:\"Loading classes...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[classes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px'},children:\"Select Class:\"}),/*#__PURE__*/_jsx(\"select\",{value:classId||'',onChange:e=>setClassId(Number(e.target.value)),style:{padding:'8px',width:'300px',fontSize:'14px'},children:classes.map(cls=>/*#__PURE__*/_jsx(\"option\",{value:cls.id,children:cls.class_name},cls.id))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:generateQR,className:\"action-btn\",disabled:!classId,children:\"Generate New QR Code\"})]}),showQR&&sessionId&&token&&/*#__PURE__*/_jsxs(\"div\",{className:\"qr-display\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Show this on Projector\"}),/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#fff3cd',border:'2px solid #ffc107',borderRadius:'8px',padding:'15px',marginBottom:'20px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{color:'#856404',fontSize:'16px'},children:\"\\u26A0\\uFE0F SECURITY WARNING\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:'#856404',marginTop:'10px',fontSize:'14px'},children:[\"Do NOT share this QR code via video call, screenshot, or photo.\",/*#__PURE__*/_jsx(\"br\",{}),\"Only students physically present in the classroom can scan this code.\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"qr-code-container\",children:/*#__PURE__*/_jsx(QRCode,{value:token,size:256})}),/*#__PURE__*/_jsx(\"p\",{className:\"qr-text\",style:{fontFamily:'monospace',wordBreak:'break-all'},children:token}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'12px',color:'#666',marginTop:'10px'},children:[\"Session ID: \",sessionId,\" | Token refreshes every 7 seconds\"]}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'11px',color:'#d32f2f',marginTop:'5px',fontWeight:'bold'},children:\"\\uD83D\\uDD12 Security: GPS verification required. Remote scanning is blocked.\"})]}),showQR&&sessionId&&!token&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',color:'#666'},children:\"Loading QR token...\"})]});}if(activeView==='scan'&&user.role==='student'){return/*#__PURE__*/_jsx(QRScanner,{user:user});}if(activeView==='attendance'&&user.role==='student'){return/*#__PURE__*/_jsx(StudentAttendance,{user:user});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-welcome\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to Attendance Management System\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select an option from the menu to get started\"}),user.role==='student'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:20},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#333',marginBottom:10},children:\"Your Subjects Summary\"}),/*#__PURE__*/_jsx(StudentSummary,{user:user})]})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:\"JSSATE BENGALURU\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"header-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-pic\",children:user.name.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-name\",children:user.name}),user.role==='student'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-id\",children:user.student_id||'Student ID'}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-course\",children:user.course||'Course'}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-section\",children:user.section||'Section'})]}),user.role==='teacher'&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-role\",children:\"Teacher\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"logout-btn\",children:\"Logout\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-divider\"}),/*#__PURE__*/_jsxs(\"main\",{className:\"dashboard-main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-grid\",children:user.role==='student'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-1\",onClick:()=>setActiveView('scan'),children:\"SCAN QR CODE\"}),/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-2\",onClick:()=>setActiveView('attendance'),children:\"MY ATTENDANCE\"}),/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-3\",onClick:()=>setActiveView('dashboard'),children:\"DASHBOARD\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-1\",onClick:()=>setActiveView('qr'),children:\"GENERATE QR\"}),/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-2\",onClick:()=>setActiveView('report'),children:\"VIEW REPORTS\"}),/*#__PURE__*/_jsx(\"button\",{className:\"dashboard-btn btn-3\",onClick:()=>setActiveView('dashboard'),children:\"DASHBOARD\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:renderDashboardContent()})]}),user.role==='student'&&/*#__PURE__*/_jsx(\"button\",{className:\"fab-scan\",onClick:()=>setActiveView('scan'),children:\"\\uD83D\\uDCF7 Scan QR\"}),/*#__PURE__*/_jsx(\"footer\",{className:\"dashboard-footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"footer-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"footer-left\",children:\"\\xA9 Copyright 2025. All Rights Reserved\"}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-right\",children:\"admissions@system.com | 080-28611702\"})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","QRCode","QRScanner","StudentAttendance","StudentSummary","API_BASE","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","_ref","user","setUser","sessionId","setSessionId","token","setToken","showQR","setShowQR","activeView","setActiveView","classId","setClassId","classes","setClasses","loadingClasses","setLoadingClasses","logout","createDefaultClass","useCallback","response","post","concat","class_name","name","teacher_id","id","data","err","alert","loadClasses","get","length","console","error","role","generateQR","code","Date","now","class_id","qr_code","session_id","_err$response","_err$response$data","errorMessage","message","includes","timer","fetchToken","r","ws","window_seconds","setTimeout","Math","max","e","clearTimeout","renderDashboardContent","className","children","style","marginBottom","display","value","onChange","Number","target","padding","width","fontSize","map","cls","onClick","disabled","backgroundColor","border","borderRadius","textAlign","color","marginTop","size","fontFamily","wordBreak","fontWeight","charAt","toUpperCase","student_id","course","section"],"sources":["C:/Users/LENOVO/Downloads/attendance-system-qr/frontend/src/pages/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport QRCode from 'react-qr-code';\r\nimport QRScanner from './QRScanner';\r\nimport StudentAttendance from './StudentAttendance';\r\nimport StudentSummary from './StudentSummary';\r\nimport './Dashboard.css';\r\nimport { API_BASE } from '../config';\r\n\r\nexport default function Dashboard({ user, setUser }) {\r\n  const [sessionId, setSessionId] = useState(null);\r\n  const [token, setToken] = useState('');\r\n  const [showQR, setShowQR] = useState(false);\r\n  const [activeView, setActiveView] = useState('dashboard');\r\n  const [classId, setClassId] = useState(null);\r\n  const [classes, setClasses] = useState([]);\r\n  const [loadingClasses, setLoadingClasses] = useState(false);\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n  };\r\n\r\n  const createDefaultClass = React.useCallback(async () => {\r\n    try {\r\n      const response = await axios.post(`${API_BASE}/api/classes`, {\r\n        class_name: `${user.name}'s Class`,\r\n        teacher_id: user.id\r\n      });\r\n      setClasses([response.data]);\r\n      setClassId(response.data.id);\r\n    } catch (err) {\r\n      alert('Failed to create default class. Please create a class first.');\r\n    }\r\n  }, [user.id, user.name]);\r\n\r\n  const loadClasses = React.useCallback(async () => {\r\n    setLoadingClasses(true);\r\n    try {\r\n      const response = await axios.get(`${API_BASE}/api/classes?teacher_id=${user.id}`);\r\n      if (response.data && response.data.length > 0) {\r\n        setClasses(response.data);\r\n        setClassId(response.data[0].id);\r\n      } else {\r\n        // Auto-create a default class for the teacher\r\n        await createDefaultClass();\r\n      }\r\n    } catch (err) {\r\n      console.error('Error loading classes:', err);\r\n    } finally {\r\n      setLoadingClasses(false);\r\n    }\r\n  }, [user.id, createDefaultClass]);\r\n\r\n  // Load classes for teacher on mount\r\n  useEffect(() => {\r\n    if (user?.role === 'teacher') {\r\n      loadClasses();\r\n    }\r\n  }, [user, loadClasses]);\r\n\r\n  const generateQR = async () => {\r\n    if (!classId) {\r\n      alert('Please select a class first or create one.');\r\n      return;\r\n    }\r\n    try {\r\n      const code = `CLASS-${user.id}-${Date.now()}`;\r\n      const response = await axios.post(`${API_BASE}/api/create-session`, {\r\n        class_id: classId,\r\n        qr_code: code\r\n      });\r\n      // Use the session_id to get rotating tokens\r\n      if (response.data.session_id) {\r\n        setSessionId(response.data.session_id);\r\n        setShowQR(true);\r\n      }\r\n    } catch (err) {\r\n      let errorMessage = 'Failed to generate QR code';\r\n      if (err.code === 'ERR_NETWORK' || err.message.includes('Network Error')) {\r\n        errorMessage = `Cannot connect to server. Please make sure the backend server is running on ${API_BASE}`;\r\n      } else if (err.response?.data?.error) {\r\n        errorMessage = err.response.data.error;\r\n        // If class doesn't exist, try to create one\r\n        if (errorMessage.includes('does not exist')) {\r\n          await createDefaultClass();\r\n          errorMessage += '\\n\\nA default class has been created. Please try again.';\r\n        }\r\n      } else {\r\n        errorMessage = `Failed to generate QR code: ${err.message}`;\r\n      }\r\n      alert(errorMessage);\r\n    }\r\n  };\r\n\r\n  // Poll rotating token when a session is active (7 seconds window)\r\n  useEffect(() => {\r\n    if (!sessionId) return;\r\n    let timer = null;\r\n    const fetchToken = async () => {\r\n      try {\r\n        const r = await axios.get(`${API_BASE}/api/qr/${sessionId}/current`);\r\n        setToken(r.data.token);\r\n        // refresh faster than server window size (7 seconds) - refresh every 5 seconds\r\n        const ws = (r.data.window_seconds || 7);\r\n        timer = setTimeout(fetchToken, Math.max(3000, ws * 700)); // 70% of window time\r\n      } catch (e) {\r\n        // ignore transient errors, but log for debugging\r\n        console.error('Error fetching token:', e);\r\n      }\r\n    };\r\n    fetchToken();\r\n    return () => { if (timer) clearTimeout(timer); };\r\n  }, [sessionId]);\r\n\r\n  const renderDashboardContent = () => {\r\n    if (activeView === 'qr' && user.role === 'teacher') {\r\n      return (\r\n        <div className=\"feature-content\">\r\n          <h2>Generate QR Code</h2>\r\n          {loadingClasses ? (\r\n            <p>Loading classes...</p>\r\n          ) : (\r\n            <>\r\n              {classes.length > 0 && (\r\n                <div style={{marginBottom: '15px'}}>\r\n                  <label style={{display: 'block', marginBottom: '5px'}}>Select Class:</label>\r\n                  <select \r\n                    value={classId || ''} \r\n                    onChange={(e) => setClassId(Number(e.target.value))}\r\n                    style={{padding: '8px', width: '300px', fontSize: '14px'}}\r\n                  >\r\n                    {classes.map(cls => (\r\n                      <option key={cls.id} value={cls.id}>{cls.class_name}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n              )}\r\n              <button onClick={generateQR} className=\"action-btn\" disabled={!classId}>\r\n                Generate New QR Code\r\n              </button>\r\n            </>\r\n          )}\r\n          {showQR && sessionId && token && (\r\n            <div className=\"qr-display\">\r\n              <h3>Show this on Projector</h3>\r\n              <div style={{\r\n                backgroundColor: '#fff3cd',\r\n                border: '2px solid #ffc107',\r\n                borderRadius: '8px',\r\n                padding: '15px',\r\n                marginBottom: '20px',\r\n                textAlign: 'center'\r\n              }}>\r\n                <strong style={{color: '#856404', fontSize: '16px'}}>‚ö†Ô∏è SECURITY WARNING</strong>\r\n                <p style={{color: '#856404', marginTop: '10px', fontSize: '14px'}}>\r\n                  Do NOT share this QR code via video call, screenshot, or photo.<br/>\r\n                  Only students physically present in the classroom can scan this code.\r\n                </p>\r\n              </div>\r\n              <div className=\"qr-code-container\">\r\n                <QRCode value={token} size={256} />\r\n              </div>\r\n              <p className=\"qr-text\" style={{fontFamily: 'monospace', wordBreak: 'break-all'}}>{token}</p>\r\n              <p style={{fontSize: '12px', color: '#666', marginTop: '10px'}}>\r\n                Session ID: {sessionId} | Token refreshes every 7 seconds\r\n              </p>\r\n              <p style={{fontSize: '11px', color: '#d32f2f', marginTop: '5px', fontWeight: 'bold'}}>\r\n                üîí Security: GPS verification required. Remote scanning is blocked.\r\n              </p>\r\n            </div>\r\n          )}\r\n          {showQR && sessionId && !token && (\r\n            <div style={{padding: '20px', color: '#666'}}>Loading QR token...</div>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (activeView === 'scan' && user.role === 'student') {\r\n      return <QRScanner user={user} />;\r\n    }\r\n\r\n    if (activeView === 'attendance' && user.role === 'student') {\r\n      return <StudentAttendance user={user} />;\r\n    }\r\n\r\n    return (\r\n      <div className=\"dashboard-welcome\">\r\n        <h2>Welcome to Attendance Management System</h2>\r\n        <p>Select an option from the menu to get started</p>\r\n        {user.role === 'student' && (\r\n          <div style={{marginTop: 20}}>\r\n            <h3 style={{color:'#333', marginBottom: 10}}>Your Subjects Summary</h3>\r\n            <StudentSummary user={user} />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <header className=\"dashboard-header\">\r\n        <div className=\"header-left\">\r\n          <div className=\"logo\">JSSATE BENGALURU</div>\r\n        </div>\r\n        <div className=\"header-right\">\r\n          <div className=\"user-profile\">\r\n            <div className=\"profile-pic\">\r\n              {user.name.charAt(0).toUpperCase()}\r\n            </div>\r\n            <div className=\"profile-info\">\r\n              <div className=\"profile-name\">{user.name}</div>\r\n              {user.role === 'student' && (\r\n                <>\r\n                  <div className=\"profile-id\">{user.student_id || 'Student ID'}</div>\r\n                  <div className=\"profile-course\">{user.course || 'Course'}</div>\r\n                  <div className=\"profile-section\">{user.section || 'Section'}</div>\r\n                </>\r\n              )}\r\n              {user.role === 'teacher' && (\r\n                <div className=\"profile-role\">Teacher</div>\r\n              )}\r\n            </div>\r\n            <button onClick={logout} className=\"logout-btn\">Logout</button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"dashboard-divider\"></div>\r\n\r\n      <main className=\"dashboard-main\">\r\n        <div className=\"dashboard-grid\">\r\n          {user.role === 'student' ? (\r\n            <>\r\n              <button \r\n                className=\"dashboard-btn btn-1\" \r\n                onClick={() => setActiveView('scan')}\r\n              >\r\n                SCAN QR CODE\r\n              </button>\r\n              <button \r\n                className=\"dashboard-btn btn-2\" \r\n                onClick={() => setActiveView('attendance')}\r\n              >\r\n                MY ATTENDANCE\r\n              </button>\r\n              <button \r\n                className=\"dashboard-btn btn-3\" \r\n                onClick={() => setActiveView('dashboard')}\r\n              >\r\n                DASHBOARD\r\n              </button>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <button \r\n                className=\"dashboard-btn btn-1\" \r\n                onClick={() => setActiveView('qr')}\r\n              >\r\n                GENERATE QR\r\n              </button>\r\n              <button \r\n                className=\"dashboard-btn btn-2\" \r\n                onClick={() => setActiveView('report')}\r\n              >\r\n                VIEW REPORTS\r\n              </button>\r\n              <button \r\n                className=\"dashboard-btn btn-3\" \r\n                onClick={() => setActiveView('dashboard')}\r\n              >\r\n                DASHBOARD\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"main-content\">\r\n          {renderDashboardContent()}\r\n        </div>\r\n      </main>\r\n\r\n      {user.role === 'student' && (\r\n        <button className=\"fab-scan\" onClick={() => setActiveView('scan')}>üì∑ Scan QR</button>\r\n      )}\r\n\r\n      <footer className=\"dashboard-footer\">\r\n        <div className=\"footer-content\">\r\n          <div className=\"footer-left\">\r\n            ¬© Copyright 2025. All Rights Reserved\r\n          </div>\r\n          <div className=\"footer-right\">\r\n            admissions@system.com | 080-28611702\r\n          </div>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,MAAM,KAAM,eAAe,CAClC,MAAO,CAAAC,SAAS,KAAM,aAAa,CACnC,MAAO,CAAAC,iBAAiB,KAAM,qBAAqB,CACnD,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAC7C,MAAO,iBAAiB,CACxB,OAASC,QAAQ,KAAQ,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAErC,cAAe,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAAoB,IAAnB,CAAEC,IAAI,CAAEC,OAAQ,CAAC,CAAAF,IAAA,CACjD,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACsB,MAAM,CAAEC,SAAS,CAAC,CAAGvB,QAAQ,CAAC,KAAK,CAAC,CAC3C,KAAM,CAACwB,UAAU,CAAEC,aAAa,CAAC,CAAGzB,QAAQ,CAAC,WAAW,CAAC,CACzD,KAAM,CAAC0B,OAAO,CAAEC,UAAU,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAC4B,OAAO,CAAEC,UAAU,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAAC8B,cAAc,CAAEC,iBAAiB,CAAC,CAAG/B,QAAQ,CAAC,KAAK,CAAC,CAE3D,KAAM,CAAAgC,MAAM,CAAGA,CAAA,GAAM,CACnBf,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAED,KAAM,CAAAgB,kBAAkB,CAAGlC,KAAK,CAACmC,WAAW,CAAC,SAAY,CACvD,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAjC,KAAK,CAACkC,IAAI,IAAAC,MAAA,CAAI9B,QAAQ,iBAAgB,CAC3D+B,UAAU,IAAAD,MAAA,CAAKrB,IAAI,CAACuB,IAAI,YAAU,CAClCC,UAAU,CAAExB,IAAI,CAACyB,EACnB,CAAC,CAAC,CACFZ,UAAU,CAAC,CAACM,QAAQ,CAACO,IAAI,CAAC,CAAC,CAC3Bf,UAAU,CAACQ,QAAQ,CAACO,IAAI,CAACD,EAAE,CAAC,CAC9B,CAAE,MAAOE,GAAG,CAAE,CACZC,KAAK,CAAC,8DAA8D,CAAC,CACvE,CACF,CAAC,CAAE,CAAC5B,IAAI,CAACyB,EAAE,CAAEzB,IAAI,CAACuB,IAAI,CAAC,CAAC,CAExB,KAAM,CAAAM,WAAW,CAAG9C,KAAK,CAACmC,WAAW,CAAC,SAAY,CAChDH,iBAAiB,CAAC,IAAI,CAAC,CACvB,GAAI,CACF,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAjC,KAAK,CAAC4C,GAAG,IAAAT,MAAA,CAAI9B,QAAQ,6BAAA8B,MAAA,CAA2BrB,IAAI,CAACyB,EAAE,CAAE,CAAC,CACjF,GAAIN,QAAQ,CAACO,IAAI,EAAIP,QAAQ,CAACO,IAAI,CAACK,MAAM,CAAG,CAAC,CAAE,CAC7ClB,UAAU,CAACM,QAAQ,CAACO,IAAI,CAAC,CACzBf,UAAU,CAACQ,QAAQ,CAACO,IAAI,CAAC,CAAC,CAAC,CAACD,EAAE,CAAC,CACjC,CAAC,IAAM,CACL;AACA,KAAM,CAAAR,kBAAkB,CAAC,CAAC,CAC5B,CACF,CAAE,MAAOU,GAAG,CAAE,CACZK,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAEN,GAAG,CAAC,CAC9C,CAAC,OAAS,CACRZ,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAAE,CAACf,IAAI,CAACyB,EAAE,CAAER,kBAAkB,CAAC,CAAC,CAEjC;AACAhC,SAAS,CAAC,IAAM,CACd,GAAI,CAAAe,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEkC,IAAI,IAAK,SAAS,CAAE,CAC5BL,WAAW,CAAC,CAAC,CACf,CACF,CAAC,CAAE,CAAC7B,IAAI,CAAE6B,WAAW,CAAC,CAAC,CAEvB,KAAM,CAAAM,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CAACzB,OAAO,CAAE,CACZkB,KAAK,CAAC,4CAA4C,CAAC,CACnD,OACF,CACA,GAAI,CACF,KAAM,CAAAQ,IAAI,UAAAf,MAAA,CAAYrB,IAAI,CAACyB,EAAE,MAAAJ,MAAA,CAAIgB,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CAC7C,KAAM,CAAAnB,QAAQ,CAAG,KAAM,CAAAjC,KAAK,CAACkC,IAAI,IAAAC,MAAA,CAAI9B,QAAQ,wBAAuB,CAClEgD,QAAQ,CAAE7B,OAAO,CACjB8B,OAAO,CAAEJ,IACX,CAAC,CAAC,CACF;AACA,GAAIjB,QAAQ,CAACO,IAAI,CAACe,UAAU,CAAE,CAC5BtC,YAAY,CAACgB,QAAQ,CAACO,IAAI,CAACe,UAAU,CAAC,CACtClC,SAAS,CAAC,IAAI,CAAC,CACjB,CACF,CAAE,MAAOoB,GAAG,CAAE,KAAAe,aAAA,CAAAC,kBAAA,CACZ,GAAI,CAAAC,YAAY,CAAG,4BAA4B,CAC/C,GAAIjB,GAAG,CAACS,IAAI,GAAK,aAAa,EAAIT,GAAG,CAACkB,OAAO,CAACC,QAAQ,CAAC,eAAe,CAAC,CAAE,CACvEF,YAAY,gFAAAvB,MAAA,CAAkF9B,QAAQ,CAAE,CAC1G,CAAC,IAAM,KAAAmD,aAAA,CAAIf,GAAG,CAACR,QAAQ,UAAAuB,aAAA,YAAAC,kBAAA,CAAZD,aAAA,CAAchB,IAAI,UAAAiB,kBAAA,WAAlBA,kBAAA,CAAoBV,KAAK,CAAE,CACpCW,YAAY,CAAGjB,GAAG,CAACR,QAAQ,CAACO,IAAI,CAACO,KAAK,CACtC;AACA,GAAIW,YAAY,CAACE,QAAQ,CAAC,gBAAgB,CAAC,CAAE,CAC3C,KAAM,CAAA7B,kBAAkB,CAAC,CAAC,CAC1B2B,YAAY,EAAI,yDAAyD,CAC3E,CACF,CAAC,IAAM,CACLA,YAAY,gCAAAvB,MAAA,CAAkCM,GAAG,CAACkB,OAAO,CAAE,CAC7D,CACAjB,KAAK,CAACgB,YAAY,CAAC,CACrB,CACF,CAAC,CAED;AACA3D,SAAS,CAAC,IAAM,CACd,GAAI,CAACiB,SAAS,CAAE,OAChB,GAAI,CAAA6C,KAAK,CAAG,IAAI,CAChB,KAAM,CAAAC,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAA/D,KAAK,CAAC4C,GAAG,IAAAT,MAAA,CAAI9B,QAAQ,aAAA8B,MAAA,CAAWnB,SAAS,YAAU,CAAC,CACpEG,QAAQ,CAAC4C,CAAC,CAACvB,IAAI,CAACtB,KAAK,CAAC,CACtB;AACA,KAAM,CAAA8C,EAAE,CAAID,CAAC,CAACvB,IAAI,CAACyB,cAAc,EAAI,CAAE,CACvCJ,KAAK,CAAGK,UAAU,CAACJ,UAAU,CAAEK,IAAI,CAACC,GAAG,CAAC,IAAI,CAAEJ,EAAE,CAAG,GAAG,CAAC,CAAC,CAAE;AAC5D,CAAE,MAAOK,CAAC,CAAE,CACV;AACAvB,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAEsB,CAAC,CAAC,CAC3C,CACF,CAAC,CACDP,UAAU,CAAC,CAAC,CACZ,MAAO,IAAM,CAAE,GAAID,KAAK,CAAES,YAAY,CAACT,KAAK,CAAC,CAAE,CAAC,CAClD,CAAC,CAAE,CAAC7C,SAAS,CAAC,CAAC,CAEf,KAAM,CAAAuD,sBAAsB,CAAGA,CAAA,GAAM,CACnC,GAAIjD,UAAU,GAAK,IAAI,EAAIR,IAAI,CAACkC,IAAI,GAAK,SAAS,CAAE,CAClD,mBACEvC,KAAA,QAAK+D,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BlE,IAAA,OAAAkE,QAAA,CAAI,kBAAgB,CAAI,CAAC,CACxB7C,cAAc,cACbrB,IAAA,MAAAkE,QAAA,CAAG,oBAAkB,CAAG,CAAC,cAEzBhE,KAAA,CAAAE,SAAA,EAAA8D,QAAA,EACG/C,OAAO,CAACmB,MAAM,CAAG,CAAC,eACjBpC,KAAA,QAAKiE,KAAK,CAAE,CAACC,YAAY,CAAE,MAAM,CAAE,CAAAF,QAAA,eACjClE,IAAA,UAAOmE,KAAK,CAAE,CAACE,OAAO,CAAE,OAAO,CAAED,YAAY,CAAE,KAAK,CAAE,CAAAF,QAAA,CAAC,eAAa,CAAO,CAAC,cAC5ElE,IAAA,WACEsE,KAAK,CAAErD,OAAO,EAAI,EAAG,CACrBsD,QAAQ,CAAGT,CAAC,EAAK5C,UAAU,CAACsD,MAAM,CAACV,CAAC,CAACW,MAAM,CAACH,KAAK,CAAC,CAAE,CACpDH,KAAK,CAAE,CAACO,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAE,OAAO,CAAEC,QAAQ,CAAE,MAAM,CAAE,CAAAV,QAAA,CAEzD/C,OAAO,CAAC0D,GAAG,CAACC,GAAG,eACd9E,IAAA,WAAqBsE,KAAK,CAAEQ,GAAG,CAAC9C,EAAG,CAAAkC,QAAA,CAAEY,GAAG,CAACjD,UAAU,EAAtCiD,GAAG,CAAC9C,EAA2C,CAC7D,CAAC,CACI,CAAC,EACN,CACN,cACDhC,IAAA,WAAQ+E,OAAO,CAAErC,UAAW,CAACuB,SAAS,CAAC,YAAY,CAACe,QAAQ,CAAE,CAAC/D,OAAQ,CAAAiD,QAAA,CAAC,sBAExE,CAAQ,CAAC,EACT,CACH,CACArD,MAAM,EAAIJ,SAAS,EAAIE,KAAK,eAC3BT,KAAA,QAAK+D,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBlE,IAAA,OAAAkE,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/BhE,KAAA,QAAKiE,KAAK,CAAE,CACVc,eAAe,CAAE,SAAS,CAC1BC,MAAM,CAAE,mBAAmB,CAC3BC,YAAY,CAAE,KAAK,CACnBT,OAAO,CAAE,MAAM,CACfN,YAAY,CAAE,MAAM,CACpBgB,SAAS,CAAE,QACb,CAAE,CAAAlB,QAAA,eACAlE,IAAA,WAAQmE,KAAK,CAAE,CAACkB,KAAK,CAAE,SAAS,CAAET,QAAQ,CAAE,MAAM,CAAE,CAAAV,QAAA,CAAC,+BAAmB,CAAQ,CAAC,cACjFhE,KAAA,MAAGiE,KAAK,CAAE,CAACkB,KAAK,CAAE,SAAS,CAAEC,SAAS,CAAE,MAAM,CAAEV,QAAQ,CAAE,MAAM,CAAE,CAAAV,QAAA,EAAC,iEACF,cAAAlE,IAAA,QAAI,CAAC,wEAEtE,EAAG,CAAC,EACD,CAAC,cACNA,IAAA,QAAKiE,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChClE,IAAA,CAACN,MAAM,EAAC4E,KAAK,CAAE3D,KAAM,CAAC4E,IAAI,CAAE,GAAI,CAAE,CAAC,CAChC,CAAC,cACNvF,IAAA,MAAGiE,SAAS,CAAC,SAAS,CAACE,KAAK,CAAE,CAACqB,UAAU,CAAE,WAAW,CAAEC,SAAS,CAAE,WAAW,CAAE,CAAAvB,QAAA,CAAEvD,KAAK,CAAI,CAAC,cAC5FT,KAAA,MAAGiE,KAAK,CAAE,CAACS,QAAQ,CAAE,MAAM,CAAES,KAAK,CAAE,MAAM,CAAEC,SAAS,CAAE,MAAM,CAAE,CAAApB,QAAA,EAAC,cAClD,CAACzD,SAAS,CAAC,oCACzB,EAAG,CAAC,cACJT,IAAA,MAAGmE,KAAK,CAAE,CAACS,QAAQ,CAAE,MAAM,CAAES,KAAK,CAAE,SAAS,CAAEC,SAAS,CAAE,KAAK,CAAEI,UAAU,CAAE,MAAM,CAAE,CAAAxB,QAAA,CAAC,+EAEtF,CAAG,CAAC,EACD,CACN,CACArD,MAAM,EAAIJ,SAAS,EAAI,CAACE,KAAK,eAC5BX,IAAA,QAAKmE,KAAK,CAAE,CAACO,OAAO,CAAE,MAAM,CAAEW,KAAK,CAAE,MAAM,CAAE,CAAAnB,QAAA,CAAC,qBAAmB,CAAK,CACvE,EACE,CAAC,CAEV,CAEA,GAAInD,UAAU,GAAK,MAAM,EAAIR,IAAI,CAACkC,IAAI,GAAK,SAAS,CAAE,CACpD,mBAAOzC,IAAA,CAACL,SAAS,EAACY,IAAI,CAAEA,IAAK,CAAE,CAAC,CAClC,CAEA,GAAIQ,UAAU,GAAK,YAAY,EAAIR,IAAI,CAACkC,IAAI,GAAK,SAAS,CAAE,CAC1D,mBAAOzC,IAAA,CAACJ,iBAAiB,EAACW,IAAI,CAAEA,IAAK,CAAE,CAAC,CAC1C,CAEA,mBACEL,KAAA,QAAK+D,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChClE,IAAA,OAAAkE,QAAA,CAAI,yCAAuC,CAAI,CAAC,cAChDlE,IAAA,MAAAkE,QAAA,CAAG,+CAA6C,CAAG,CAAC,CACnD3D,IAAI,CAACkC,IAAI,GAAK,SAAS,eACtBvC,KAAA,QAAKiE,KAAK,CAAE,CAACmB,SAAS,CAAE,EAAE,CAAE,CAAApB,QAAA,eAC1BlE,IAAA,OAAImE,KAAK,CAAE,CAACkB,KAAK,CAAC,MAAM,CAAEjB,YAAY,CAAE,EAAE,CAAE,CAAAF,QAAA,CAAC,uBAAqB,CAAI,CAAC,cACvElE,IAAA,CAACH,cAAc,EAACU,IAAI,CAAEA,IAAK,CAAE,CAAC,EAC3B,CACN,EACE,CAAC,CAEV,CAAC,CAED,mBACEL,KAAA,QAAK+D,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClChE,KAAA,WAAQ+D,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAClClE,IAAA,QAAKiE,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC1BlE,IAAA,QAAKiE,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAC,kBAAgB,CAAK,CAAC,CACzC,CAAC,cACNlE,IAAA,QAAKiE,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BhE,KAAA,QAAK+D,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BlE,IAAA,QAAKiE,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzB3D,IAAI,CAACuB,IAAI,CAAC6D,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAC/B,CAAC,cACN1F,KAAA,QAAK+D,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BlE,IAAA,QAAKiE,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAE3D,IAAI,CAACuB,IAAI,CAAM,CAAC,CAC9CvB,IAAI,CAACkC,IAAI,GAAK,SAAS,eACtBvC,KAAA,CAAAE,SAAA,EAAA8D,QAAA,eACElE,IAAA,QAAKiE,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAE3D,IAAI,CAACsF,UAAU,EAAI,YAAY,CAAM,CAAC,cACnE7F,IAAA,QAAKiE,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAE3D,IAAI,CAACuF,MAAM,EAAI,QAAQ,CAAM,CAAC,cAC/D9F,IAAA,QAAKiE,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAE3D,IAAI,CAACwF,OAAO,EAAI,SAAS,CAAM,CAAC,EAClE,CACH,CACAxF,IAAI,CAACkC,IAAI,GAAK,SAAS,eACtBzC,IAAA,QAAKiE,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAC,SAAO,CAAK,CAC3C,EACE,CAAC,cACNlE,IAAA,WAAQ+E,OAAO,CAAExD,MAAO,CAAC0C,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,QAAM,CAAQ,CAAC,EAC5D,CAAC,CACH,CAAC,EACA,CAAC,cAETlE,IAAA,QAAKiE,SAAS,CAAC,mBAAmB,CAAM,CAAC,cAEzC/D,KAAA,SAAM+D,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC9BlE,IAAA,QAAKiE,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC5B3D,IAAI,CAACkC,IAAI,GAAK,SAAS,cACtBvC,KAAA,CAAAE,SAAA,EAAA8D,QAAA,eACElE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,MAAM,CAAE,CAAAkD,QAAA,CACtC,cAED,CAAQ,CAAC,cACTlE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,YAAY,CAAE,CAAAkD,QAAA,CAC5C,eAED,CAAQ,CAAC,cACTlE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,WAAW,CAAE,CAAAkD,QAAA,CAC3C,WAED,CAAQ,CAAC,EACT,CAAC,cAEHhE,KAAA,CAAAE,SAAA,EAAA8D,QAAA,eACElE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,IAAI,CAAE,CAAAkD,QAAA,CACpC,aAED,CAAQ,CAAC,cACTlE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,QAAQ,CAAE,CAAAkD,QAAA,CACxC,cAED,CAAQ,CAAC,cACTlE,IAAA,WACEiE,SAAS,CAAC,qBAAqB,CAC/Bc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,WAAW,CAAE,CAAAkD,QAAA,CAC3C,WAED,CAAQ,CAAC,EACT,CACH,CACE,CAAC,cAENlE,IAAA,QAAKiE,SAAS,CAAC,cAAc,CAAAC,QAAA,CAC1BF,sBAAsB,CAAC,CAAC,CACtB,CAAC,EACF,CAAC,CAENzD,IAAI,CAACkC,IAAI,GAAK,SAAS,eACtBzC,IAAA,WAAQiE,SAAS,CAAC,UAAU,CAACc,OAAO,CAAEA,CAAA,GAAM/D,aAAa,CAAC,MAAM,CAAE,CAAAkD,QAAA,CAAC,sBAAU,CAAQ,CACtF,cAEDlE,IAAA,WAAQiE,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cAClChE,KAAA,QAAK+D,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BlE,IAAA,QAAKiE,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,0CAE7B,CAAK,CAAC,cACNlE,IAAA,QAAKiE,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAC,sCAE9B,CAAK,CAAC,EACH,CAAC,CACA,CAAC,EACN,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}