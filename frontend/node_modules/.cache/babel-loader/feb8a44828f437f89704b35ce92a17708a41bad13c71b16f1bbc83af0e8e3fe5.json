{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{Html5Qrcode,Html5QrcodeSupportedFormats}from'html5-qrcode';import axios from'axios';import{generateDeviceFingerprint}from'../utils/deviceFingerprint';import'./QRScanner.css';import{API_BASE}from'../config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function QRScanner(_ref){let{user}=_ref;const html5QrCodeRef=useRef(null);const[error,setError]=useState(null);const[isRetrying,setIsRetrying]=useState(false);const[isScanning,setIsScanning]=useState(false);const[scanMode,setScanMode]=useState('camera');// 'camera' or 'manual'\nconst[manualToken,setManualToken]=useState('');useEffect(()=>{// Only initialize camera if scanMode is 'camera'\nif(scanMode!=='camera'){return;}let isMounted=true;// Define handleCameraError first\nconst handleCameraError=errorMessage=>{if(!isMounted)return;let userFriendlyMessage=\"Camera error: \";if(errorMessage.includes(\"NotReadableError\")||errorMessage.includes(\"Could not start video source\")){userFriendlyMessage+=\"Camera is already in use by another app. Please close other apps using the camera and try again.\";}else if(errorMessage.includes(\"Permission denied\")||errorMessage.includes(\"NotAllowedError\")){userFriendlyMessage+=\"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\";}else if(errorMessage.includes(\"NotFoundError\")||errorMessage.includes(\"no camera\")){userFriendlyMessage+=\"No camera found on this device.\";}else{userFriendlyMessage+=errorMessage;}setError(userFriendlyMessage);setIsScanning(false);};// Global error handler to catch unhandled errors\nconst globalErrorHandler=event=>{var _event$error$message,_event$error$message2,_event$error$message3;if(event.error&&((_event$error$message=event.error.message)!==null&&_event$error$message!==void 0&&_event$error$message.includes(\"NotReadableError\")||(_event$error$message2=event.error.message)!==null&&_event$error$message2!==void 0&&_event$error$message2.includes(\"Could not start video source\")||(_event$error$message3=event.error.message)!==null&&_event$error$message3!==void 0&&_event$error$message3.includes(\"userMedia\")||event.error.name===\"NotReadableError\")){event.preventDefault();if(isMounted){handleCameraError(event.error.message||\"Camera error: Could not start video source. Please close other apps using the camera.\");}}};// Add global error listener\nwindow.addEventListener('error',globalErrorHandler);window.addEventListener('unhandledrejection',event=>{var _event$reason$message,_event$reason$message2,_event$reason$message3;if(event.reason&&((_event$reason$message=event.reason.message)!==null&&_event$reason$message!==void 0&&_event$reason$message.includes(\"NotReadableError\")||(_event$reason$message2=event.reason.message)!==null&&_event$reason$message2!==void 0&&_event$reason$message2.includes(\"Could not start video source\")||(_event$reason$message3=event.reason.message)!==null&&_event$reason$message3!==void 0&&_event$reason$message3.includes(\"userMedia\"))){event.preventDefault();if(isMounted){handleCameraError(event.reason.message||\"Camera error: Could not start video source.\");}}});const handleScanSuccess=async(token,scanner)=>{if(!isMounted)return;try{// Stop scanning temporarily\nawait scanner.stop();setIsScanning(false);navigator.geolocation.getCurrentPosition(async pos=>{if(!isMounted)return;const{latitude,longitude}=pos.coords;const device_fingerprint=generateDeviceFingerprint();try{const res=await axios.post(\"\".concat(API_BASE,\"/api/attendance-token\"),{student_id:user.id,token,latitude,longitude,device_fingerprint});if(res.data.error){alert(\"Error: \"+res.data.error);}else{alert(res.data.message||\"Attendance marked successfully!\");}// Restart scanner\nif(isMounted){startScanner();}}catch(err){var _err$response,_err$response$data;alert(\"Failed to mark attendance: \"+(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message));// Restart scanner\nif(isMounted){startScanner();}}},()=>{alert(\"Enable GPS to mark attendance.\");// Restart scanner\nif(isMounted){startScanner();}});}catch(e){console.error(\"Error handling scan:\",e);if(isMounted){startScanner();}}};const startScanner=async()=>{if(!isMounted)return;// Clear any previous error\nsetError(null);// Check if getUserMedia is supported\nif(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){setError(\"Camera access is not supported in this browser. Please use a modern browser like Chrome, Firefox, or Safari.\");return;}// Check if we're on HTTPS or localhost (required for camera access)\nconst isSecureContext=window.isSecureContext||window.location.protocol==='https:'||window.location.hostname==='localhost'||window.location.hostname==='127.0.0.1'||window.location.hostname.startsWith('192.168.')||window.location.hostname.startsWith('10.')||window.location.hostname.startsWith('172.');if(!isSecureContext){setError(\"Camera access requires HTTPS. Please access this site via HTTPS or use a local network address.\");return;}// Clean up any existing scanner\nif(html5QrCodeRef.current){try{await html5QrCodeRef.current.stop().catch(()=>{});await html5QrCodeRef.current.clear().catch(()=>{});}catch(e){console.log(\"Cleaning up previous scanner:\",e);}}const qrboxSize=window.innerWidth<480?220:280;const html5QrCode=new Html5Qrcode(\"reader\");html5QrCodeRef.current=html5QrCode;try{// Step 1: Request camera permission explicitly first\ntry{const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:\"environment\"}});// Stop the test stream immediately\nstream.getTracks().forEach(track=>track.stop());}catch(permErr){if(isMounted){if(permErr.name===\"NotAllowedError\"||permErr.name===\"PermissionDeniedError\"){handleCameraError(\"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\");}else if(permErr.name===\"NotFoundError\"||permErr.name===\"DevicesNotFoundError\"){handleCameraError(\"No camera found on this device.\");}else if(permErr.name===\"NotReadableError\"||permErr.name===\"TrackStartError\"){handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");}else{handleCameraError(\"Camera access error: \".concat(permErr.message||permErr.name));}return;}}// Step 2: Get available cameras\nlet cameraId=null;try{const devices=await Html5Qrcode.getCameras();if(devices&&devices.length>0){// Prefer back camera (environment) on mobile\nconst backCamera=devices.find(device=>device.label.toLowerCase().includes('back')||device.label.toLowerCase().includes('rear')||device.label.toLowerCase().includes('environment'));cameraId=backCamera?backCamera.id:devices[0].id;}}catch(e){console.log(\"Could not enumerate cameras, using default:\",e);}// Step 3: Mobile-friendly camera configuration\nconst config={fps:10,qrbox:{width:qrboxSize,height:qrboxSize},aspectRatio:1.0,formatsToSupport:[Html5QrcodeSupportedFormats.QR_CODE]};// Step 4: Start the scanner with comprehensive error handling\ntry{// Add small delay to ensure camera is ready\nawait new Promise(resolve=>setTimeout(resolve,500));await html5QrCode.start(cameraId||{facingMode:\"environment\"},config,decodedText=>{// Success callback\nif(isMounted){const token=decodedText;handleScanSuccess(token,html5QrCode);}},errorMessage=>{// Error callback - catch all camera-related errors\nif(isMounted){const errorStr=(errorMessage===null||errorMessage===void 0?void 0:errorMessage.toString())||String(errorMessage)||'';if(errorStr.includes(\"NotReadableError\")||errorStr.includes(\"Could not start video source\")||errorStr.includes(\"Permission denied\")||errorStr.includes(\"NotFoundError\")||errorStr.includes(\"NotAllowedError\")||errorStr.includes(\"TrackStartError\")||errorStr.includes(\"DevicesNotFoundError\")||errorStr.includes(\"getUserMedia\")){handleCameraError(errorStr);}}}).catch(err=>{// Additional catch for promise rejection\nif(isMounted){const errorStr=(err===null||err===void 0?void 0:err.message)||(err===null||err===void 0?void 0:err.toString())||String(err);if(errorStr.includes(\"NotReadableError\")||errorStr.includes(\"Could not start video source\")){handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");}else{handleCameraError(\"Camera error: \".concat(errorStr));}}});if(isMounted){setIsScanning(true);}}catch(startErr){// Catch any errors during start()\nif(isMounted){const errorStr=(startErr===null||startErr===void 0?void 0:startErr.message)||(startErr===null||startErr===void 0?void 0:startErr.toString())||String(startErr);if(errorStr.includes(\"NotReadableError\")||errorStr.includes(\"Could not start video source\")){handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");}else if(errorStr.includes(\"Permission denied\")||errorStr.includes(\"NotAllowedError\")){handleCameraError(\"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\");}else if(errorStr.includes(\"NotFoundError\")){handleCameraError(\"No camera found on this device.\");}else{handleCameraError(\"Failed to start camera: \".concat(errorStr));}}}}catch(err){// Final catch-all for any unexpected errors\nif(isMounted){const errorStr=err.message||err.toString();handleCameraError(\"Camera initialization error: \".concat(errorStr));}}};startScanner();return()=>{isMounted=false;// Remove global error listeners\nwindow.removeEventListener('error',globalErrorHandler);const cleanup=async()=>{if(html5QrCodeRef.current){try{await html5QrCodeRef.current.stop().catch(()=>{});await html5QrCodeRef.current.clear().catch(()=>{});}catch(e){console.log(\"Error cleaning up scanner:\",e);}}};cleanup();};},[user,isRetrying,scanMode]);const handleRetry=async()=>{setError(null);// Force cleanup before retry\nif(html5QrCodeRef.current){try{await html5QrCodeRef.current.stop().catch(()=>{});await html5QrCodeRef.current.clear().catch(()=>{});}catch(e){console.log(\"Cleanup on retry:\",e);}}// Small delay to ensure cleanup is complete, then trigger retry\nsetTimeout(()=>{setIsRetrying(prev=>!prev);},500);};const handleManualSubmit=async()=>{if(!manualToken.trim()){setError('Please enter the token');return;}setError(null);const token=manualToken.trim();// Use the same success handler as camera scan\nnavigator.geolocation.getCurrentPosition(async pos=>{const{latitude,longitude}=pos.coords;const device_fingerprint=generateDeviceFingerprint();try{const res=await axios.post(\"\".concat(API_BASE,\"/api/attendance-token\"),{student_id:user.id,token,latitude,longitude,device_fingerprint});if(res.data.error){setError(\"Error: \"+res.data.error);}else{alert(res.data.message||\"Attendance marked successfully!\");setManualToken('');// Clear input\n}}catch(err){var _err$response2,_err$response2$data;setError(\"Failed to mark attendance: \"+(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message));}},()=>{setError(\"Enable GPS to mark attendance.\");});};return/*#__PURE__*/_jsxs(\"div\",{className:\"qr-scanner-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"qr-scanner-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Mark Attendance\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px',marginBottom:'20px',justifyContent:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setScanMode('camera');setError(null);setManualToken('');},style:{padding:'10px 20px',backgroundColor:scanMode==='camera'?'#4CAF50':'#e0e0e0',color:scanMode==='camera'?'white':'#333',border:'none',borderRadius:'5px',cursor:'pointer',fontSize:'14px',fontWeight:scanMode==='camera'?'bold':'normal'},children:\"\\uD83D\\uDCF7 Scan QR Code\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setScanMode('manual');setError(null);// Stop camera if running\nif(html5QrCodeRef.current){html5QrCodeRef.current.stop().catch(()=>{});html5QrCodeRef.current.clear().catch(()=>{});}},style:{padding:'10px 20px',backgroundColor:scanMode==='manual'?'#4CAF50':'#e0e0e0',color:scanMode==='manual'?'white':'#333',border:'none',borderRadius:'5px',cursor:'pointer',fontSize:'14px',fontWeight:scanMode==='manual'?'bold':'normal'},children:\"\\u2328\\uFE0F Enter Token\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#e3f2fd',border:'1px solid #2196F3',borderRadius:'8px',padding:'12px',marginBottom:'15px',fontSize:'13px',color:'#1565c0'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u26A0\\uFE0F Important:\"}),\" You must be physically present in the classroom to mark attendance. GPS location verification is required. Remote attendance is blocked.\"]}),scanMode==='camera'?/*#__PURE__*/_jsx(\"p\",{children:\"Point your camera at the QR code displayed in class. Your location and device information will be verified.\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{marginBottom:'15px'},children:\"Enter the token shown by your teacher on the projector screen.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'10px',maxWidth:'400px',margin:'0 auto'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:manualToken,onChange:e=>setManualToken(e.target.value),placeholder:\"Enter token here (e.g., CLASS-123-4567890)\",style:{padding:'12px',fontSize:'16px',border:'2px solid #ddd',borderRadius:'5px',textAlign:'center'},onKeyPress:e=>{if(e.key==='Enter'){handleManualSubmit();}}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleManualSubmit,style:{padding:'12px 24px',backgroundColor:'#4CAF50',color:'white',border:'none',borderRadius:'5px',cursor:'pointer',fontSize:'16px',fontWeight:'bold'},children:\"Submit Token\"})]})]})]}),scanMode==='camera'&&!isScanning&&!error&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e3f2fd',border:'1px solid #90caf9',borderRadius:'8px',padding:'15px',margin:'15px 0',color:'#1565c0',textAlign:'center'},children:\"Initializing camera...\"}),error&&/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#fee',border:'1px solid #fcc',borderRadius:'8px',padding:'15px',margin:'15px 0',color:'#c33'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Error:\"}),\" \",error,/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRetry,style:{padding:'8px 16px',backgroundColor:'#4CAF50',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px',marginRight:'10px'},children:\"Retry Camera\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),style:{padding:'8px 16px',backgroundColor:'#2196F3',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px'},children:\"Refresh Page\"})]})]}),scanMode==='camera'&&/*#__PURE__*/_jsx(\"div\",{className:\"qr-reader-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{id:\"reader\"})}),scanMode==='manual'&&/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'20px',backgroundColor:'#f5f5f5',borderRadius:'8px',marginTop:'20px'},children:/*#__PURE__*/_jsxs(\"p\",{style:{color:'#666',fontSize:'14px'},children:[\"\\uD83D\\uDCA1 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Tip:\"}),\" Look at the projector screen for the token text below the QR code. Type it exactly as shown (including dashes and numbers).\"]})})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","Html5Qrcode","Html5QrcodeSupportedFormats","axios","generateDeviceFingerprint","API_BASE","jsx","_jsx","jsxs","_jsxs","QRScanner","_ref","user","html5QrCodeRef","error","setError","isRetrying","setIsRetrying","isScanning","setIsScanning","scanMode","setScanMode","manualToken","setManualToken","isMounted","handleCameraError","errorMessage","userFriendlyMessage","includes","globalErrorHandler","event","_event$error$message","_event$error$message2","_event$error$message3","message","name","preventDefault","window","addEventListener","_event$reason$message","_event$reason$message2","_event$reason$message3","reason","handleScanSuccess","token","scanner","stop","navigator","geolocation","getCurrentPosition","pos","latitude","longitude","coords","device_fingerprint","res","post","concat","student_id","id","data","alert","startScanner","err","_err$response","_err$response$data","response","e","console","mediaDevices","getUserMedia","isSecureContext","location","protocol","hostname","startsWith","current","catch","clear","log","qrboxSize","innerWidth","html5QrCode","stream","video","facingMode","getTracks","forEach","track","permErr","cameraId","devices","getCameras","length","backCamera","find","device","label","toLowerCase","config","fps","qrbox","width","height","aspectRatio","formatsToSupport","QR_CODE","Promise","resolve","setTimeout","start","decodedText","errorStr","toString","String","startErr","removeEventListener","cleanup","handleRetry","prev","handleManualSubmit","trim","_err$response2","_err$response2$data","className","children","style","display","gap","marginBottom","justifyContent","onClick","padding","backgroundColor","color","border","borderRadius","cursor","fontSize","fontWeight","flexDirection","maxWidth","margin","type","value","onChange","target","placeholder","textAlign","onKeyPress","key","marginTop","marginRight","reload"],"sources":["C:/Users/LENOVO/Downloads/attendance-system-qr/frontend/src/pages/QRScanner.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { Html5Qrcode, Html5QrcodeSupportedFormats } from 'html5-qrcode';\r\nimport axios from 'axios';\r\nimport { generateDeviceFingerprint } from '../utils/deviceFingerprint';\r\nimport './QRScanner.css';\r\nimport { API_BASE } from '../config';\r\n\r\nexport default function QRScanner({ user }) {\r\n  const html5QrCodeRef = useRef(null);\r\n  const [error, setError] = useState(null);\r\n  const [isRetrying, setIsRetrying] = useState(false);\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [scanMode, setScanMode] = useState('camera'); // 'camera' or 'manual'\r\n  const [manualToken, setManualToken] = useState('');\r\n\r\n  useEffect(() => {\r\n    // Only initialize camera if scanMode is 'camera'\r\n    if (scanMode !== 'camera') {\r\n      return;\r\n    }\r\n\r\n    let isMounted = true;\r\n    \r\n    // Define handleCameraError first\r\n    const handleCameraError = (errorMessage) => {\r\n      if (!isMounted) return;\r\n      \r\n      let userFriendlyMessage = \"Camera error: \";\r\n      \r\n      if (errorMessage.includes(\"NotReadableError\") || errorMessage.includes(\"Could not start video source\")) {\r\n        userFriendlyMessage += \"Camera is already in use by another app. Please close other apps using the camera and try again.\";\r\n      } else if (errorMessage.includes(\"Permission denied\") || errorMessage.includes(\"NotAllowedError\")) {\r\n        userFriendlyMessage += \"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\";\r\n      } else if (errorMessage.includes(\"NotFoundError\") || errorMessage.includes(\"no camera\")) {\r\n        userFriendlyMessage += \"No camera found on this device.\";\r\n      } else {\r\n        userFriendlyMessage += errorMessage;\r\n      }\r\n      \r\n      setError(userFriendlyMessage);\r\n      setIsScanning(false);\r\n    };\r\n    \r\n    // Global error handler to catch unhandled errors\r\n    const globalErrorHandler = (event) => {\r\n      if (event.error && (\r\n        event.error.message?.includes(\"NotReadableError\") ||\r\n        event.error.message?.includes(\"Could not start video source\") ||\r\n        event.error.message?.includes(\"userMedia\") ||\r\n        event.error.name === \"NotReadableError\"\r\n      )) {\r\n        event.preventDefault();\r\n        if (isMounted) {\r\n          handleCameraError(event.error.message || \"Camera error: Could not start video source. Please close other apps using the camera.\");\r\n        }\r\n      }\r\n    };\r\n\r\n    // Add global error listener\r\n    window.addEventListener('error', globalErrorHandler);\r\n    window.addEventListener('unhandledrejection', (event) => {\r\n      if (event.reason && (\r\n        event.reason.message?.includes(\"NotReadableError\") ||\r\n        event.reason.message?.includes(\"Could not start video source\") ||\r\n        event.reason.message?.includes(\"userMedia\")\r\n      )) {\r\n        event.preventDefault();\r\n        if (isMounted) {\r\n          handleCameraError(event.reason.message || \"Camera error: Could not start video source.\");\r\n        }\r\n      }\r\n    });\r\n\r\n    const handleScanSuccess = async (token, scanner) => {\r\n      if (!isMounted) return;\r\n      \r\n      try {\r\n        // Stop scanning temporarily\r\n        await scanner.stop();\r\n        setIsScanning(false);\r\n\r\n        navigator.geolocation.getCurrentPosition(\r\n          async (pos) => {\r\n            if (!isMounted) return;\r\n            \r\n            const { latitude, longitude } = pos.coords;\r\n            const device_fingerprint = generateDeviceFingerprint();\r\n\r\n            try {\r\n              const res = await axios.post(`${API_BASE}/api/attendance-token`, {\r\n                student_id: user.id,\r\n                token,\r\n                latitude,\r\n                longitude,\r\n                device_fingerprint\r\n              });\r\n\r\n              if (res.data.error) {\r\n                alert(\"Error: \" + res.data.error);\r\n              } else {\r\n                alert(res.data.message || \"Attendance marked successfully!\");\r\n              }\r\n              \r\n              // Restart scanner\r\n              if (isMounted) {\r\n                startScanner();\r\n              }\r\n            } catch (err) {\r\n              alert(\"Failed to mark attendance: \" + (err.response?.data?.error || err.message));\r\n              // Restart scanner\r\n              if (isMounted) {\r\n                startScanner();\r\n              }\r\n            }\r\n          },\r\n          () => {\r\n            alert(\"Enable GPS to mark attendance.\");\r\n            // Restart scanner\r\n            if (isMounted) {\r\n              startScanner();\r\n            }\r\n          }\r\n        );\r\n      } catch (e) {\r\n        console.error(\"Error handling scan:\", e);\r\n        if (isMounted) {\r\n          startScanner();\r\n        }\r\n      }\r\n    };\r\n\r\n    const startScanner = async () => {\r\n      if (!isMounted) return;\r\n      \r\n      // Clear any previous error\r\n      setError(null);\r\n\r\n      // Check if getUserMedia is supported\r\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\r\n        setError(\"Camera access is not supported in this browser. Please use a modern browser like Chrome, Firefox, or Safari.\");\r\n        return;\r\n      }\r\n\r\n      // Check if we're on HTTPS or localhost (required for camera access)\r\n      const isSecureContext = window.isSecureContext || \r\n        window.location.protocol === 'https:' || \r\n        window.location.hostname === 'localhost' || \r\n        window.location.hostname === '127.0.0.1' ||\r\n        window.location.hostname.startsWith('192.168.') ||\r\n        window.location.hostname.startsWith('10.') ||\r\n        window.location.hostname.startsWith('172.');\r\n\r\n      if (!isSecureContext) {\r\n        setError(\"Camera access requires HTTPS. Please access this site via HTTPS or use a local network address.\");\r\n        return;\r\n      }\r\n\r\n      // Clean up any existing scanner\r\n      if (html5QrCodeRef.current) {\r\n        try {\r\n          await html5QrCodeRef.current.stop().catch(() => {});\r\n          await html5QrCodeRef.current.clear().catch(() => {});\r\n        } catch (e) {\r\n          console.log(\"Cleaning up previous scanner:\", e);\r\n        }\r\n      }\r\n\r\n      const qrboxSize = window.innerWidth < 480 ? 220 : 280;\r\n      const html5QrCode = new Html5Qrcode(\"reader\");\r\n      html5QrCodeRef.current = html5QrCode;\r\n\r\n      try {\r\n        // Step 1: Request camera permission explicitly first\r\n        try {\r\n          const stream = await navigator.mediaDevices.getUserMedia({ \r\n            video: { facingMode: \"environment\" } \r\n          });\r\n          // Stop the test stream immediately\r\n          stream.getTracks().forEach(track => track.stop());\r\n        } catch (permErr) {\r\n          if (isMounted) {\r\n            if (permErr.name === \"NotAllowedError\" || permErr.name === \"PermissionDeniedError\") {\r\n              handleCameraError(\"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\");\r\n            } else if (permErr.name === \"NotFoundError\" || permErr.name === \"DevicesNotFoundError\") {\r\n              handleCameraError(\"No camera found on this device.\");\r\n            } else if (permErr.name === \"NotReadableError\" || permErr.name === \"TrackStartError\") {\r\n              handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");\r\n            } else {\r\n              handleCameraError(`Camera access error: ${permErr.message || permErr.name}`);\r\n            }\r\n            return;\r\n          }\r\n        }\r\n\r\n        // Step 2: Get available cameras\r\n        let cameraId = null;\r\n        try {\r\n          const devices = await Html5Qrcode.getCameras();\r\n          if (devices && devices.length > 0) {\r\n            // Prefer back camera (environment) on mobile\r\n            const backCamera = devices.find(device => \r\n              device.label.toLowerCase().includes('back') || \r\n              device.label.toLowerCase().includes('rear') ||\r\n              device.label.toLowerCase().includes('environment')\r\n            );\r\n            cameraId = backCamera ? backCamera.id : devices[0].id;\r\n          }\r\n        } catch (e) {\r\n          console.log(\"Could not enumerate cameras, using default:\", e);\r\n        }\r\n\r\n        // Step 3: Mobile-friendly camera configuration\r\n        const config = {\r\n          fps: 10,\r\n          qrbox: { width: qrboxSize, height: qrboxSize },\r\n          aspectRatio: 1.0,\r\n          formatsToSupport: [Html5QrcodeSupportedFormats.QR_CODE]\r\n        };\r\n\r\n        // Step 4: Start the scanner with comprehensive error handling\r\n        try {\r\n          // Add small delay to ensure camera is ready\r\n          await new Promise(resolve => setTimeout(resolve, 500));\r\n          \r\n          await html5QrCode.start(\r\n            cameraId || { facingMode: \"environment\" },\r\n            config,\r\n            (decodedText) => {\r\n              // Success callback\r\n              if (isMounted) {\r\n                const token = decodedText;\r\n                handleScanSuccess(token, html5QrCode);\r\n              }\r\n            },\r\n            (errorMessage) => {\r\n              // Error callback - catch all camera-related errors\r\n              if (isMounted) {\r\n                const errorStr = errorMessage?.toString() || String(errorMessage) || '';\r\n                if (errorStr.includes(\"NotReadableError\") || \r\n                    errorStr.includes(\"Could not start video source\") ||\r\n                    errorStr.includes(\"Permission denied\") ||\r\n                    errorStr.includes(\"NotFoundError\") ||\r\n                    errorStr.includes(\"NotAllowedError\") ||\r\n                    errorStr.includes(\"TrackStartError\") ||\r\n                    errorStr.includes(\"DevicesNotFoundError\") ||\r\n                    errorStr.includes(\"getUserMedia\")) {\r\n                  handleCameraError(errorStr);\r\n                }\r\n              }\r\n            }\r\n          ).catch((err) => {\r\n            // Additional catch for promise rejection\r\n            if (isMounted) {\r\n              const errorStr = err?.message || err?.toString() || String(err);\r\n              if (errorStr.includes(\"NotReadableError\") || errorStr.includes(\"Could not start video source\")) {\r\n                handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");\r\n              } else {\r\n                handleCameraError(`Camera error: ${errorStr}`);\r\n              }\r\n            }\r\n          });\r\n          \r\n          if (isMounted) {\r\n            setIsScanning(true);\r\n          }\r\n        } catch (startErr) {\r\n          // Catch any errors during start()\r\n          if (isMounted) {\r\n            const errorStr = startErr?.message || startErr?.toString() || String(startErr);\r\n            if (errorStr.includes(\"NotReadableError\") || errorStr.includes(\"Could not start video source\")) {\r\n              handleCameraError(\"Camera is already in use by another app. Please close other apps using the camera and try again.\");\r\n            } else if (errorStr.includes(\"Permission denied\") || errorStr.includes(\"NotAllowedError\")) {\r\n              handleCameraError(\"Camera permission was denied. Please allow camera access in your browser settings and refresh the page.\");\r\n            } else if (errorStr.includes(\"NotFoundError\")) {\r\n              handleCameraError(\"No camera found on this device.\");\r\n            } else {\r\n              handleCameraError(`Failed to start camera: ${errorStr}`);\r\n            }\r\n          }\r\n        }\r\n      } catch (err) {\r\n        // Final catch-all for any unexpected errors\r\n        if (isMounted) {\r\n          const errorStr = err.message || err.toString();\r\n          handleCameraError(`Camera initialization error: ${errorStr}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    startScanner();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      // Remove global error listeners\r\n      window.removeEventListener('error', globalErrorHandler);\r\n      const cleanup = async () => {\r\n        if (html5QrCodeRef.current) {\r\n          try {\r\n            await html5QrCodeRef.current.stop().catch(() => {});\r\n            await html5QrCodeRef.current.clear().catch(() => {});\r\n          } catch (e) {\r\n            console.log(\"Error cleaning up scanner:\", e);\r\n          }\r\n        }\r\n      };\r\n      cleanup();\r\n    };\r\n  }, [user, isRetrying, scanMode]);\r\n\r\n  const handleRetry = async () => {\r\n    setError(null);\r\n    \r\n    // Force cleanup before retry\r\n    if (html5QrCodeRef.current) {\r\n      try {\r\n        await html5QrCodeRef.current.stop().catch(() => {});\r\n        await html5QrCodeRef.current.clear().catch(() => {});\r\n      } catch (e) {\r\n        console.log(\"Cleanup on retry:\", e);\r\n      }\r\n    }\r\n    \r\n    // Small delay to ensure cleanup is complete, then trigger retry\r\n    setTimeout(() => {\r\n      setIsRetrying(prev => !prev);\r\n    }, 500);\r\n  };\r\n\r\n  const handleManualSubmit = async () => {\r\n    if (!manualToken.trim()) {\r\n      setError('Please enter the token');\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    const token = manualToken.trim();\r\n    \r\n    // Use the same success handler as camera scan\r\n    navigator.geolocation.getCurrentPosition(\r\n      async (pos) => {\r\n        const { latitude, longitude } = pos.coords;\r\n        const device_fingerprint = generateDeviceFingerprint();\r\n\r\n        try {\r\n          const res = await axios.post(`${API_BASE}/api/attendance-token`, {\r\n            student_id: user.id,\r\n            token,\r\n            latitude,\r\n            longitude,\r\n            device_fingerprint\r\n          });\r\n\r\n          if (res.data.error) {\r\n            setError(\"Error: \" + res.data.error);\r\n          } else {\r\n            alert(res.data.message || \"Attendance marked successfully!\");\r\n            setManualToken(''); // Clear input\r\n          }\r\n        } catch (err) {\r\n          setError(\"Failed to mark attendance: \" + (err.response?.data?.error || err.message));\r\n        }\r\n      },\r\n      () => {\r\n        setError(\"Enable GPS to mark attendance.\");\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"qr-scanner-container\">\r\n      <div className=\"qr-scanner-header\">\r\n        <h2>Mark Attendance</h2>\r\n        \r\n        {/* Mode Toggle */}\r\n        <div style={{\r\n          display: 'flex',\r\n          gap: '10px',\r\n          marginBottom: '20px',\r\n          justifyContent: 'center'\r\n        }}>\r\n          <button\r\n            onClick={() => {\r\n              setScanMode('camera');\r\n              setError(null);\r\n              setManualToken('');\r\n            }}\r\n            style={{\r\n              padding: '10px 20px',\r\n              backgroundColor: scanMode === 'camera' ? '#4CAF50' : '#e0e0e0',\r\n              color: scanMode === 'camera' ? 'white' : '#333',\r\n              border: 'none',\r\n              borderRadius: '5px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: scanMode === 'camera' ? 'bold' : 'normal'\r\n            }}\r\n          >\r\n            üì∑ Scan QR Code\r\n          </button>\r\n          <button\r\n            onClick={() => {\r\n              setScanMode('manual');\r\n              setError(null);\r\n              // Stop camera if running\r\n              if (html5QrCodeRef.current) {\r\n                html5QrCodeRef.current.stop().catch(() => {});\r\n                html5QrCodeRef.current.clear().catch(() => {});\r\n              }\r\n            }}\r\n            style={{\r\n              padding: '10px 20px',\r\n              backgroundColor: scanMode === 'manual' ? '#4CAF50' : '#e0e0e0',\r\n              color: scanMode === 'manual' ? 'white' : '#333',\r\n              border: 'none',\r\n              borderRadius: '5px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: scanMode === 'manual' ? 'bold' : 'normal'\r\n            }}\r\n          >\r\n            ‚å®Ô∏è Enter Token\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{\r\n          backgroundColor: '#e3f2fd',\r\n          border: '1px solid #2196F3',\r\n          borderRadius: '8px',\r\n          padding: '12px',\r\n          marginBottom: '15px',\r\n          fontSize: '13px',\r\n          color: '#1565c0'\r\n        }}>\r\n          <strong>‚ö†Ô∏è Important:</strong> You must be physically present in the classroom to mark attendance. \r\n          GPS location verification is required. Remote attendance is blocked.\r\n        </div>\r\n\r\n        {scanMode === 'camera' ? (\r\n          <p>\r\n            Point your camera at the QR code displayed in class. Your location and device information will be verified.\r\n          </p>\r\n        ) : (\r\n          <div>\r\n            <p style={{ marginBottom: '15px' }}>\r\n              Enter the token shown by your teacher on the projector screen.\r\n            </p>\r\n            <div style={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              gap: '10px',\r\n              maxWidth: '400px',\r\n              margin: '0 auto'\r\n            }}>\r\n              <input\r\n                type=\"text\"\r\n                value={manualToken}\r\n                onChange={(e) => setManualToken(e.target.value)}\r\n                placeholder=\"Enter token here (e.g., CLASS-123-4567890)\"\r\n                style={{\r\n                  padding: '12px',\r\n                  fontSize: '16px',\r\n                  border: '2px solid #ddd',\r\n                  borderRadius: '5px',\r\n                  textAlign: 'center'\r\n                }}\r\n                onKeyPress={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    handleManualSubmit();\r\n                  }\r\n                }}\r\n              />\r\n              <button\r\n                onClick={handleManualSubmit}\r\n                style={{\r\n                  padding: '12px 24px',\r\n                  backgroundColor: '#4CAF50',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '5px',\r\n                  cursor: 'pointer',\r\n                  fontSize: '16px',\r\n                  fontWeight: 'bold'\r\n                }}\r\n              >\r\n                Submit Token\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {scanMode === 'camera' && !isScanning && !error && (\r\n        <div style={{\r\n          backgroundColor: '#e3f2fd',\r\n          border: '1px solid #90caf9',\r\n          borderRadius: '8px',\r\n          padding: '15px',\r\n          margin: '15px 0',\r\n          color: '#1565c0',\r\n          textAlign: 'center'\r\n        }}>\r\n          Initializing camera...\r\n        </div>\r\n      )}\r\n\r\n      {error && (\r\n        <div style={{\r\n          backgroundColor: '#fee',\r\n          border: '1px solid #fcc',\r\n          borderRadius: '8px',\r\n          padding: '15px',\r\n          margin: '15px 0',\r\n          color: '#c33'\r\n        }}>\r\n          <strong>Error:</strong> {error}\r\n          <div style={{ marginTop: '10px' }}>\r\n            <button \r\n              onClick={handleRetry}\r\n              style={{\r\n                padding: '8px 16px',\r\n                backgroundColor: '#4CAF50',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer',\r\n                fontSize: '14px',\r\n                marginRight: '10px'\r\n              }}\r\n            >\r\n              Retry Camera\r\n            </button>\r\n            <button \r\n              onClick={() => window.location.reload()}\r\n              style={{\r\n                padding: '8px 16px',\r\n                backgroundColor: '#2196F3',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer',\r\n                fontSize: '14px'\r\n              }}\r\n            >\r\n              Refresh Page\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {scanMode === 'camera' && (\r\n        <div className=\"qr-reader-wrapper\">\r\n          <div id=\"reader\"></div>\r\n        </div>\r\n      )}\r\n      \r\n      {scanMode === 'manual' && (\r\n        <div style={{\r\n          textAlign: 'center',\r\n          padding: '20px',\r\n          backgroundColor: '#f5f5f5',\r\n          borderRadius: '8px',\r\n          marginTop: '20px'\r\n        }}>\r\n          <p style={{ color: '#666', fontSize: '14px' }}>\r\n            üí° <strong>Tip:</strong> Look at the projector screen for the token text below the QR code.\r\n            Type it exactly as shown (including dashes and numbers).\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}