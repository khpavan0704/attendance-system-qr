{"ast":null,"code":"// Register service worker for PWA functionality\nexport function registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL || ''}/sw.js`;\n      navigator.serviceWorker.register(swUrl).then(registration => {\n        console.log('SW registered: ', registration);\n\n        // Check for updates periodically\n        registration.onupdatefound = () => {\n          const installingWorker = registration.installing;\n          if (installingWorker == null) {\n            return;\n          }\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // New content available, prompt user to refresh\n                console.log('New content available; please refresh.');\n\n                // FIXED: Use window.confirm instead of confirm\n                if (window.confirm('New version available! Reload to update?')) {\n                  window.location.reload();\n                }\n              } else {\n                // Content cached for offline use\n                console.log('Content cached for offline use.');\n              }\n            }\n          };\n        };\n      }).catch(error => {\n        console.error('SW registration failed: ', error);\n      });\n    });\n  }\n}\n\n// Check if app is running as PWA (installed)\nexport function isPWA() {\n  return window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone || document.referrer.includes('android-app://');\n}\n\n// Install prompt handler\nlet deferredPrompt;\nexport function setInstallPrompt(prompt) {\n  deferredPrompt = prompt;\n}\nexport async function showInstallPrompt() {\n  if (!deferredPrompt) {\n    return false;\n  }\n  deferredPrompt.prompt();\n  const {\n    outcome\n  } = await deferredPrompt.userChoice;\n  deferredPrompt = null;\n  return outcome === 'accepted';\n}\n\n// Listen for install prompt\nexport function listenForInstallPrompt() {\n  window.addEventListener('beforeinstallprompt', e => {\n    e.preventDefault();\n    setInstallPrompt(e);\n    console.log('Install prompt available');\n    return false;\n  });\n}","map":{"version":3,"names":["registerServiceWorker","navigator","window","addEventListener","swUrl","process","env","PUBLIC_URL","serviceWorker","register","then","registration","console","log","onupdatefound","installingWorker","installing","onstatechange","state","controller","confirm","location","reload","catch","error","isPWA","matchMedia","matches","standalone","document","referrer","includes","deferredPrompt","setInstallPrompt","prompt","showInstallPrompt","outcome","userChoice","listenForInstallPrompt","e","preventDefault"],"sources":["C:/Users/LENOVO/Downloads/attendance-system-qr/frontend/src/utils/registerServiceWorker.js"],"sourcesContent":["// Register service worker for PWA functionality\r\nexport function registerServiceWorker() {\r\n  if ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL || ''}/sw.js`;\r\n\r\n      navigator.serviceWorker\r\n        .register(swUrl)\r\n        .then((registration) => {\r\n          console.log('SW registered: ', registration);\r\n\r\n          // Check for updates periodically\r\n          registration.onupdatefound = () => {\r\n            const installingWorker = registration.installing;\r\n            if (installingWorker == null) {\r\n              return;\r\n            }\r\n\r\n            installingWorker.onstatechange = () => {\r\n              if (installingWorker.state === 'installed') {\r\n                if (navigator.serviceWorker.controller) {\r\n                  // New content available, prompt user to refresh\r\n                  console.log('New content available; please refresh.');\r\n\r\n                  // FIXED: Use window.confirm instead of confirm\r\n                  if (window.confirm('New version available! Reload to update?')) {\r\n                    window.location.reload();\r\n                  }\r\n\r\n                } else {\r\n                  // Content cached for offline use\r\n                  console.log('Content cached for offline use.');\r\n                }\r\n              }\r\n            };\r\n          };\r\n        })\r\n        .catch((error) => {\r\n          console.error('SW registration failed: ', error);\r\n        });\r\n    });\r\n  }\r\n}\r\n\r\n// Check if app is running as PWA (installed)\r\nexport function isPWA() {\r\n  return window.matchMedia('(display-mode: standalone)').matches ||\r\n         window.navigator.standalone ||\r\n         document.referrer.includes('android-app://');\r\n}\r\n\r\n// Install prompt handler\r\nlet deferredPrompt;\r\n\r\nexport function setInstallPrompt(prompt) {\r\n  deferredPrompt = prompt;\r\n}\r\n\r\nexport async function showInstallPrompt() {\r\n  if (!deferredPrompt) {\r\n    return false;\r\n  }\r\n\r\n  deferredPrompt.prompt();\r\n  const { outcome } = await deferredPrompt.userChoice;\r\n  deferredPrompt = null;\r\n  \r\n  return outcome === 'accepted';\r\n}\r\n\r\n// Listen for install prompt\r\nexport function listenForInstallPrompt() {\r\n  window.addEventListener('beforeinstallprompt', (e) => {\r\n    e.preventDefault();\r\n    setInstallPrompt(e);\r\n    console.log('Install prompt available');\r\n    return false;\r\n  });\r\n}\r\n"],"mappings":"AAAA;AACA,OAAO,SAASA,qBAAqBA,CAAA,EAAG;EACtC,IAAI,eAAe,IAAIC,SAAS,EAAE;IAChCC,MAAM,CAACC,gBAAgB,CAAC,MAAM,EAAE,MAAM;MACpC,MAAMC,KAAK,GAAG,GAAGC,OAAO,CAACC,GAAG,CAACC,UAAU,IAAI,EAAE,QAAQ;MAErDN,SAAS,CAACO,aAAa,CACpBC,QAAQ,CAACL,KAAK,CAAC,CACfM,IAAI,CAAEC,YAAY,IAAK;QACtBC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,YAAY,CAAC;;QAE5C;QACAA,YAAY,CAACG,aAAa,GAAG,MAAM;UACjC,MAAMC,gBAAgB,GAAGJ,YAAY,CAACK,UAAU;UAChD,IAAID,gBAAgB,IAAI,IAAI,EAAE;YAC5B;UACF;UAEAA,gBAAgB,CAACE,aAAa,GAAG,MAAM;YACrC,IAAIF,gBAAgB,CAACG,KAAK,KAAK,WAAW,EAAE;cAC1C,IAAIjB,SAAS,CAACO,aAAa,CAACW,UAAU,EAAE;gBACtC;gBACAP,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;;gBAErD;gBACA,IAAIX,MAAM,CAACkB,OAAO,CAAC,0CAA0C,CAAC,EAAE;kBAC9DlB,MAAM,CAACmB,QAAQ,CAACC,MAAM,CAAC,CAAC;gBAC1B;cAEF,CAAC,MAAM;gBACL;gBACAV,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;cAChD;YACF;UACF,CAAC;QACH,CAAC;MACH,CAAC,CAAC,CACDU,KAAK,CAAEC,KAAK,IAAK;QAChBZ,OAAO,CAACY,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAClD,CAAC,CAAC;IACN,CAAC,CAAC;EACJ;AACF;;AAEA;AACA,OAAO,SAASC,KAAKA,CAAA,EAAG;EACtB,OAAOvB,MAAM,CAACwB,UAAU,CAAC,4BAA4B,CAAC,CAACC,OAAO,IACvDzB,MAAM,CAACD,SAAS,CAAC2B,UAAU,IAC3BC,QAAQ,CAACC,QAAQ,CAACC,QAAQ,CAAC,gBAAgB,CAAC;AACrD;;AAEA;AACA,IAAIC,cAAc;AAElB,OAAO,SAASC,gBAAgBA,CAACC,MAAM,EAAE;EACvCF,cAAc,GAAGE,MAAM;AACzB;AAEA,OAAO,eAAeC,iBAAiBA,CAAA,EAAG;EACxC,IAAI,CAACH,cAAc,EAAE;IACnB,OAAO,KAAK;EACd;EAEAA,cAAc,CAACE,MAAM,CAAC,CAAC;EACvB,MAAM;IAAEE;EAAQ,CAAC,GAAG,MAAMJ,cAAc,CAACK,UAAU;EACnDL,cAAc,GAAG,IAAI;EAErB,OAAOI,OAAO,KAAK,UAAU;AAC/B;;AAEA;AACA,OAAO,SAASE,sBAAsBA,CAAA,EAAG;EACvCpC,MAAM,CAACC,gBAAgB,CAAC,qBAAqB,EAAGoC,CAAC,IAAK;IACpDA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClBP,gBAAgB,CAACM,CAAC,CAAC;IACnB3B,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACvC,OAAO,KAAK;EACd,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}